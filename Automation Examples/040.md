# Process

Create an excel file with headers (Srno, Countries, Fert. Rate, Med. Age, Aggregate). Srno values count should start from 1. Open http://www.worldometers.info/world-population/population-by-country/ and extract data about first 15 countries that match the following conditions.

1. Fert. Rate is more than 2.5

2. Med. Age is more than 27

Then, insert Aggregate formulae to the excel and send an email with the attachment.

# Steps to automate

#### 1. Open the website and focus Chrome window

Make sure to enable addon selenium from the View/Addons panel.

```G1ANT
selenium.open type chrome url http://www.worldometers.info/world-population/population-by-country/
window ✱Population✱ style maximize
```

#### 2. Create an excel file and fill it with headers

The C# snippet `⊂♥headers.Count⊃` returns a number of `♥headers` elements. In each iteration of a loop, a header is appended to the excel.

```G1ANT
♥path = ‴C:\Users\dell\Desktop\Automation Anywhere\countries.xlsx‴
xlsx.open ♥path createifnotexist true

♥headers = Srno❚Countries❚Fert. Rate❚Med. Age❚Aggregate

for ♥i from 1 to ⊂♥headers.Count⊃
    xlsx.setvalue value ♥headers⟦♥i⟧ row 1 colindex ♥i
end for
```

#### 3. Get a number of records that are on the website

Right click any record's value that is in the first column and choose "Inspect Element", copy the class name and using JavaScript, get a number of its elements.

```G1ANT
selenium.runscript ‴return document.getElementsByClassName("sorting_1").length‴ result ♥websiteRecordsNumber
```

#### 4. Create a loop with no body but with the correct conditions

`♥websiteRecordsNumber` must be of an integer structure because it will be compared to the `♥i` variable storing a number of a website record that is being currently processed. `♥excelRecordsNumber` is a number of records matchting the criteria from the "process description". So it is probably the best option here to use a while loop which should end if there are no more records on the website (`♥i` is equal to `♥websiteRecordsNumber`) or if `♥excelRecordsNumber` is 15.

```G1ANT
♥websiteRecordsNumber = ⟦integer⟧♥websiteRecordsNumber
♥i = 1
♥excelRecordsNumber = 1

while ⊂♥i < ♥websiteRecordsNumber && ♥excelRecordsNumber < 16⊃
    ♥i = ♥i + 1
end while
```

#### 5. Get Fert. Rate and Med. Age values inside a loop

Right click on any Fert. Rate value and choose "Inspect Element", right click the selected code in the developer tools and choose "Copy Xpath" that you can insert as below, remembering to replace the current number of website record with the `♥i` variable. Do the same with Med. Age.

```G1ANT
    selenium.gettext search ‴//*[@id="example2"]/tbody/tr[♥i]/td[9]‴ by xpath result ♥fertRate
    selenium.gettext search ‴//*[@id="example2"]/tbody/tr[♥i]/td[10]‴ by xpath result ♥medAge
```

#### 6.

```G1ANT

```

#### 7.

```G1ANT

```

#### 8.

```G1ANT

```

#### 9.

```G1ANT

```

# Final Code

```G1ANT
selenium.open type chrome url http://www.worldometers.info/world-population/population-by-country/
window ✱Population✱ style maximize
♥path = ‴C:\Users\dell\Desktop\Automation Examples\countries.xlsx‴
xlsx.open ♥path createifnotexist true

♥headers = Srno❚Countries❚Fert. Rate❚Med. Age❚Aggregate

call FillExcel list ♥headers

selenium.runscript ‴return document.getElementsByClassName("sorting_1").length‴ result ♥websiteRecordsNumber
♥websiteRecordsNumber = ⟦integer⟧♥websiteRecordsNumber
♥i = 1
♥excelRecordsNumber = 1

while ⊂♥i < ♥websiteRecordsNumber && ♥excelRecordsNumber < 16⊃

    selenium.gettext search ‴//*[@id="example2"]/tbody/tr[♥i]/td[9]‴ by xpath result ♥fertRate
    selenium.gettext search ‴//*[@id="example2"]/tbody/tr[♥i]/td[10]‴ by xpath result ♥medAge
    
    if ⊂!♥fertRate.Contains("N.A.") && !♥medAge.Contains("N.A.")⊃
        ♥fertRate = ⟦float⟧♥fertRate
        ♥medAge = ⟦float⟧♥medAge
    
        if ⊂♥fertRate > 2.5 && ♥medAge > 27⊃
            selenium.gettext search ‴//*[@id="example2"]/tbody/tr[♥i]/td[2]/a‴ by xpath result ♥country
            list.create ‴♥excelRecordsNumber❚♥country❚♥fertRate❚♥medAge❚⊂(♥fertRate*0.05)+♥medAge⊃‴ type text result ♥rowValues
            call FillExcel rowNumber ⊂♥excelRecordsNumber+1⊃ list ♥rowValues
            ♥excelRecordsNumber = ♥excelRecordsNumber + 1
        end if
    end if
    
    ♥i = ♥i + 1
end while

call StopScript

list.create text ♥path result ♥attachments
mail.smtp host ‴imap.gmail.com‴ login ‴user@gmail.com‴ password ‴p@$$w0rD‴ from ‴robot@gmail.com‴ to ‴robotuser@g1ant.com‴ subject ‴Csv attachment‴ body ‴Hi, here's your countries info‴ attachments ♥attachments

procedure FillExcel rowNumber 1 list ⟦list:text⟧a❚b❚c
    for ♥j from 1 to ⊂♥list.Count⊃
        xlsx.setvalue value ♥list⟦♥j⟧ row ♥rowNumber colindex ♥j
    end for
end procedure

procedure StopScript
    xlsx.close
    selenium.close
end procedure
```
